.lh 9
.cw 11
             Full Matrix Factorization Functions

     Matriø  factorizatioî  ió  thå generiã terí  foò  methodó 
whicè spliô á matriø intï á producô oæ twï oò morå factoró  tï 
facilitatå  solutioî oæ problemó sucè aó solutioî oæ  simulta
neouó lineaò algebraiã equations®   Gaussiaî elimination¬ likå 
thå methodó showî here¬ factoró á matriø intï á producô oæ twï 
triangulaò  matrices¬  buô  onå oæ thå triangulaò matriceó  ió 
discardeä immediately®   Factorizatioî methodó arå alwayó morå 
efficienô thaî truå inversioî methods» wheneveò thå producô oæ 
aî inverså witè anotheò matriø ió desired¬  iô caî bå replaceä 
bù  thå  forwarä anä bacë substitutioî  usinç  thå  triangulaò 
factors.

     Amonç  thå operationó possiblå buô noô showî arå  forminç 
thå  inverså bù operatinç oî aî identitù matrix¬  anä checkinç 
thå  factorizatioî  bù  operatinç oî á copù  oæ  thå  originaì 
matrix¬  tï seå iæ aî identitù matriø results®   Thå usuaì uså 
ió  operatioî  oî á singlå righô hanä sidå vectoò tï  solvå  á 
singlå systeí oæ equations®   Iî manù applications¬  iteratioî 
ió  used¬  wherå ne÷ righô hanä sidå vectoró maù bå  developeä 
later¬ foò solutioî witè thå factoró obtaineä previously.

     Thå  methoä  showî iî EQD.Ã ió Crouô  factorizatioî  witè 
scaleä  partiaì  pivoting®   Equivalenô methodó arå  showî  iî 
severaì  textbooks¬  sï wå wilì concentratå oî  implementatioî 
questionó whicè arå hardeò tï finä iî references®   Mosô  pub
lisheä programó arå giveî iî obsoletå dialectó oæ FORTRAN¬ anä 
havå  extrá  looğ  iterationó whicè dï  nothinç  buô  activatå 
unnecessarù conditionaì GOTO's.

     Compacô  factorizatioî methods¬  oæ whicè Crout'ó ió  thå 
besô known¬  havå ordeò N2” storeó tï memory¬ whilå morå commoî 
methodó  havå ordeò N3” stores®   Thå differencå iî speeä mighô 
bå expecteä tï sho÷ uğ oî machineó witè á slo÷ memorù buó  anä 
fasô floatinç poinô CPU¬  sucè aó thå 8088-808· pair®  Certaiî 
pipelininç  machineó  sucè aó Floatinç Poinô Systemó  ruî  50¥ 
fasteò  aó theù ruî aô á speeä paceä bù memorù access®   Crouô 
alsï takeó advantagå oæ extendeä precisioî tï improvå  accura
cy¬  aó  computationó arå shorteneä tï memorù formaô precisioî 
onlù wheî stored®   Agaiî thió shoulä favoò theiò uså oî  808· 
oò 6888± machines®  Computatioî usinç C'ó normaì conventioî oæ 
promotioî  tï doublå giveó thió effecô automaticallù wheî ope
ratinç oî floaô arrays®  

     Á  deficiencù whicè Ã shareó witè Pascaì ió thaô thå sizå 
oæ multiplù subscripteä arrayó musô bå knowî aô  preprocessinç 
time¬ whilå FORTRAÎ anä PL/É allo÷ thå sizå tï bå giveî aô ruî Štime®   Thió  differencå  ió misunderstooä bù somå authoró  oæ 
comparativå programminç languagå textbooks®   Whilå therå  arå 
wayó  arounä this¬  theù arå noô aó cleaî aó á changå oæ  lan
guage®   Ã doeó permiô thå firsô dimension¬  equivalenô tï thå 
lasô  dimensioî  oæ FORTRAN¬  tï vary¬  sï thaô  thå  fwdbak(© 
functioî  caî bå writteî tï operatå oî anythinç froí á  columî 
vectoò tï á squarå matriø oò beyond.

     Therå  arå opportunitieó tï inverô á numbeò anä replacå á 
largå  numbeò  oæ divideó witè aî equaì numbeò  oæ  multiplieó 
pluó thå inversion®  Thió ió wortè doinç iî thå scalå factors¬ 
sincå  thå inaccuracù onlù breakó tieó iî pivoô  choices®   Iî 
thå divisioî bù diagonaì elements¬ thå extrá roundofæ caî gro÷ 
tï  significanô  deterioratioî iî finaì  results¬  unlesó  thå 
inverteä numbeò ió carrieä iî extrá precision®   Oî thoså  ma
chineó whicè havå nï dividå instruction¬ thå compileò oughô tï 
bå  ablå  tï movå thå reciprocaì instructioî ouô oæ thå  loop» 
thuó  iô  makeó nï senså tï penalizå  normaì  computers®   Thå 
extrá  timå takeî bù thå usuaì dividå oæ abouô twicå thå  timå 
oæ á multiplù oò adä ió insignificant.

     Thå initializatioî oæ thå doô productó tï 0®  ratheò thaî 
tï  thå  valuå whicè ió tï bå changeä improveó  accuracù  wheî 
therå  ió  nï extendeä precision®   Thió happenó  becauså  thå 
valuå  tï bå changeä ofteî ió thå largesô  iî  magnitude¬  anä 
shoulä bå thå lasô added®

     Iæ  thå originaì matriø caî bå assumeä accuratå aô  leasô 
tï  thå precisioî oæ thå arithmetic¬  aî accuracù estimatå  oæ 
.1¬  thå  worsô  likelù iî á properlù poseä physicaì  problem¬ 
meanó thaô thå factoró havå losô ± decimaì placå oæ  accuracy®  
Oî thå ordeò 1² Hilberô matrix¬  wå havå aî estimatå oæ 4e-14¬ 
whicè indicateó thaô á maximuí erroò oæ .00³ mighô possiblù bå 
achieveä witè standarä 1¶ digiô accuracù witè alì calculationó 
carrieä tï lonç doublå precisioî beforå rounding®  Aî accuracù 
estimatå oæ lesó thaî 1e-1¶ woulä sho÷ singularitù oò neeä foò 
higheò precision.

     Testinç  witè pseudo-randoí numberó ió noô  satisfactory¬ 
sincå randoí numbeò generatoró usuallù generatå onlù numbeò oæ 
3±  bitó  oò less¬  anä thå numberó generateä bù onå ruî  timå 
librarù  wilì poså á lesó severå tesô thaî  another®   Hilberô 
matriceó  arå ofteî useä withouô scaling®   Witè thå  scaling¬ 
thå  coefficientó arå exacô anä thå tesô ió noô madå easieò bù 
roundofæ iî fillinç ouô thå tesô matrix®   Thió ió noô á  tri
viaì  question¬  aó  somå  authoró havå claimeä thaô  IBÍ  37° 
machineó caî factoò sucè á matriø oæ ordeò 1¶ successfullù  iî 
doublå precision¬ whilå theù faiì thå ordeò 1² tesô wheî iô ió 
donå  carefully®   Á  largeò scalinç whicè makeó morå  oæ  thå Šcalculationó exacô iî thå forwarä anä bacë substitutionó giveó 
morå consistenô resultó thaî thå minimuí requireä foò aî exacô 
tesô matrix.

    Iî  benchmarkó comparinç variouó machines¬  wå  havå  useä 
botè  thå  schemå  herå whicè compareó thå solutioî  witè  thå 
exacô  vectoò  oæ  alì 1'ó anä thå checë  oæ  multiplyinç  thå 
matriø bù itó equivalenô inverse®   Thå MIØ compileò giveó thå 
excellenô  erroò oæ .02· iî thå slo÷ timå oæ 3°  secondó  (2.µ 
Mhú Z80)®   EcoÃ doeó noô accepô doublå subscripts®  Microsofô 
doublå precisioî softwarå floatinç poinô takeó 2´ secondó witè 
aî erroò oæ .35®   Azteã takeó 2¹ secondó foò aî erroò oæ 2.3¬ 
whicè  ió worså thaî eveî thå biç IBM's®   Thió ió á resulô oæ 
Aztec'ó  unusuaì choicå oæ baså 25¶ ratheò thaî normaì  binarù 
floatinç point®  Oî computeró witè hardwarå floatinç point¬ wå 
perforí thå timinç tesô oî á matriø oæ ordeò 100¬  usinç ordeò 
1² onlù tï tesô accuracy®  Typicaì 6802° computeró witè Weiteë 
floatinç poinô ruî abouô 300° timeó Z8° speed.

     Symmetriã  matrices¬  sucè aó ouò tesô matrix¬  ariså  iî 
importanô  applicationó sucè aó statisticó anä finitå  elemenô 
analysis®  Mosô oæ theså matriceó arå positivå definite¬ whicè 
meanó thaô thå diagonaì elementó oæ thå triangulaò factoò wilì 
alwayó  bå  positivå withouô requirinç  pivoting®   Sincå  thå 
matriø  cannoô bå storeä efficientlù iî á  rectangulaò  array¬ 
anä  finitå elemenô applicationó producå matriceó whicè caî bå 
packeä  furtheò bù skippinç elementó whicè arå knowî á  prioré 
tï  bå zerï iî thå factors¬  wå chooså thå variablå  bandwidtè 
columî storagå formaô iî EQSYM.C®

     Textbookó  morå  ofteî  chooså thå Choleské  squarå  rooô 
method¬  whicè  ió lesó accuratå anä lesó  general¬  anä  morå 
ofteî sho÷ á constanô bandwidtè method¬  whicè permitó rectan
gulaò (doublå subscripted© storagå aô thå expenså oæ efficien
cy®   Algorithmó sucè aó "reverså Cuthill-McKee¢ perforí auto
matiã  sortinç oæ equationó intï á morå compacô variablå  banä 
storage.

     Factorizatioî intï thå forí Ì Ä Lt” avoidó thå  inaccuracù 
oæ thå squarå rooô method¬  anä workó oî negativå definitå anä 
ofteî  eveî  indefinitå matrices®   Á peculiaritù ió thaô  thå 
factoò  Ä  Lt”  ió calculateä firsô anä replaceä  aô  thå  lasô 
instanô bù itó finaì form®   Iî thå forward-bacë substitution¬ 
threå loopó arå required¬ accordinç tï thå threå factoró whicè 
arå  formallù  employed®   Thå seconä anä thirä loopó  caî  bå 
combineä iî thå fixeä bandwidtè form¬ wherå thå bacë substitu
tioî  caî bå donå bù doô products®   Iî thå variablå bandwidtè 
oò otheò fulì symmetriã packeä storagå schemes¬  thå doô  proŠducô bacë substitutioî ió toï inefficient¬  aó thå elementó oæ 
thå  rowó  oæ Lt” arå storeä aô varyinç  intervals®   Thå  bacë 
substitutioî  shown¬  whicè ió likå Gaussiaî forwarä  elimina
tion¬ ió mucè fasteò buô slightlù lesó accurate.

     Thå  callinç  prograí provideó aî arraù oæ indiceó  whicè 
poinô tï thå diagonaì elementó oæ thå matrix®  Sincå thå partó 
oæ  thå matriø columnó whicè arå storeä enä oî  thå  diagonal¬ 
thió  arraù  containó enougè informatioî tï describå thå  com
pletå forí oæ thå matrix®  Iî á typicaì variablå bandeä appli
cation¬  onlù  á  fe÷ columnó wilì starô oî thå ° ro÷  oæ  thå 
matriø aó theù dï foò á fulì matrix®  Thå storeä columî startó 
witè thå firsô ro÷ containinç á non-zerï element.

     Aô firsô iô mighô seeí thaô iî Ã á vectoò oæ pointeró  tï 
thå diagonaì elementó ratheò thaî arraù indiceó coulä bå used®  
Thió turnó ouô tï complicatå thå code¬  althougè iô eliminateó 
aî argumenô oæ thå functions®   Recoverù oæ thå columî lengthó 
ió  toï difficulô witè thå limitationó oæ pointeò  arithmetic¬ 
whicè noô alì compileró arå willinç tï tackle.

     MIØ  anä  EcoÃ  achievå identicaì respectablå  erroró  oæ 
0.059¬  whilå Azteã ió sï pooò aó noô tï bå suitablå foò  thió 
algorithm®   Althougè thå reorderinç oæ equationó performeä iî 
EQD.Ã ió noô requireä foò success¬ iô improveó accuracù aô thå 
cosô oæ nearlù twicå aó mucè time.

     Aî  unsymmetriã versioî oæ thå variablå bandwidtè  methoä 
(EQVB.C© ió effectivå iî finitå differencå methods¬  wherå thå 
storagå  patterî aó welì aó thå coefficientó arå likelù tï  bå 
unsymmetric®   Theså  methodó arå ofteî successfuì  wherå  thå 
ordeò oæ equationó ió noô guaranteeä tï bå correct¬  yeô iô ió 
impracticaì  tï  changå iô tï maximizå  pivots®   Accuracù  ió 
usuallù  betteò  thaî symmetriã methodó (thå differencå ió  iî 
thå forwarä substitution)»  howeveò iô ió noô recommendeä  un
lesó  thå matriø ió sparså enougè tï makå iô ruî significantlù 
fasteò thaî thå morå generaì methoä oæ EQD.C.
